# LE SYST√àME DE SURVEILLANCE H26

<img src="../images/file-20221209-20279-c0jq3z.jpeg.avif" alt="Syst√®me de surveillance" width="500" />


# √ânonc√© du TP01.2026 ‚Äì Version 1.0

---

## Le travail pratique num√©ro 1 sera r√©alis√© en deux √©tapes:

## Partie 01, 15%, √† remettre √† la semaine 6 ‚Äì 5 mars 
## Partie 02, 15%, √† remettre √† la semaine 8 ‚Äì 19 mars

---

## 1. Partie 01 ‚Äì Remise semaine 06 ‚Äì 5 mars, 16h00.

**En utilisant un Arduino UNO, avec les modules groves suivants:**

* **LED1** sur D2
* **LED2** sur D3
* **Relai** sur D4
* **Capteur** de temp√©rature (**SHT31**) sur I2C -> [notes de cours](https://ve2cuy.com/420-1c4/index.php/grove-module-humidite-et-temperature/)
* **RGB\_LCD** sur I2C -> [notes de cours](https://ve2cuy.com/420-1c4/index.php/grove-module-lcd-rgb-i2c/)
* Le moniteur s√©rie √† **4800** bauds

**√âcrire une application pour Arduino UNO, en utilisant VS Code et PlatformIO, qui affiche l'√©cran suivant dans la console s√©rie (serial monitor):**

<img src="../images/Capture-decran-le-2025-02-13-a-22.02.09-1024x573.png" alt="Console s√©rie" width="500" />

**Et l'√©cran suivant sur le LCD:**

<img src="../images/Capture-decran-le-2025-02-12-a-10.59.06.png" alt="√âcran LCD" width="500" />

---

**NOTE**: Les options 1 √† 3, affich√©es sur la console, sont des actions qui peuvent √™tre lanc√©es √† partir du clavier pour contr√¥ler certains modules du syst√®me.

Par exemple, pour allumer ou √©teindre la LED sur D2 il suffira d'appuyer sur la touche 1 du clavier.

<img src="../images/Capture-decran-le-2025-02-12-a-12.19.23.png" alt="Saisie clavier" width="500" />

```cpp
// Astuce: Saisie d'une touche du clavier √† partir de la console s√©rie

if (Serial.available()) {      // Si un octet disponible sur le port Serial
    commande = Serial.read();  // Lecture d'un octet (touche clavier)
    
    // Traitement de la commande ...
    if (commande == '1') alors allumer/√©teindre DEL1;
}
```

---

## D√©monstration de l'application

[Vid√©o de d√©monstration](https://ve2cuy.com/420-1c4/wp-content/uploads/2025/02/420-1c4.tp01-partie01.mov)

---

## D√©tails et actions des options du menu (Items 1 √† 3)

L'application doit permettre la saisie de caract√®res √† partir du terminal s√©rie. Cette saisie, permet l'ex√©cution de certaines fonctions de l'application. Les options sont identifi√©es par des num√©ros au d√©but des lignes de l'interface. Par exemple, le '3 -' dans '3 ‚Äì RELAI' indique qu'il est possible de contr√¥ler le relai en appuyant sur la touche '3' du clavier.

**NOTE**: Assurez-vous que le focus est dans la fen√™tre du terminal s√©rie avant d'appuyer sur une touche.

Donc, √©tant donn√© le menu suivant,

<img src="../images/Capture-decran-le-2025-02-13-a-15.03.05.png" alt="Menu options" width="500" />

1. LED1 sur D2
   * Permet d'allumer/√âteindre la DEL connect√©e sur D2
   * Au bout de la ligne, il faut afficher l'√©tat: **ON** ou **OFF**
     + **Sous forme de ¬´ toggle ¬ª, permutation de l'√©tat.**
2. LED2 sur D3
   * Permet d'allumer/√âteindre la DEL connect√©e sur D3
   * Au bout de la ligne, il faut afficher l'√©tat: **ON** ou **OFF**
3. RELAI D4
   * Permet d'allumer/√âteindre le RELAI connect√© sur D4
   * Au bout de la ligne, il faut afficher l'√©tat: **ON** ou **OFF**

**NOTE**: **ON** doit-√™tre affich√© en **vert** et OFF en **rouge**.

üëâ **√âL√âMENTS PRESCRITS OBLIGATOIRES:**

Il faut programmer les fonctions suivantes pour l'affichage des √©tats ON/OFF et de temp√©rature/Humidit√©.

```cpp
void afficherOnOff(int posX, int posY, bool on = true);
void afficherTemperatureEtHumidite(int posX, int posY);
```

---

## D√©tails des modules (appareils) de contr√¥le

* Capteur de temp√©rature, connect√© sur le port I2C
  + Lecture de la temp√©rature et de l'humidit√© pour affichage dans la deuxi√®me partie de l'√©cran du moniteur s√©rie.
* LCD, connect√© sur le port I2C
  + Sert √† afficher le message 'Alarme: ON' sur la premi√®re ligne
  + Le temps √©coul√© depuis le d√©marrage de l'arduino en JOURS:HR:MM:SEC

<img src="../images/Capture-decran-le-2025-02-12-a-10.59.06.png" alt="LCD temps" width="500" />

---

## D√©tails des √©l√©ments de la deuxi√®me partie de l'√©cran

<img src="../images/Capture-decran-le-2025-02-13-a-15.05.41.png" alt="Deuxi√®me partie √©cran" width="500" />

* **Temp√©rature**: Il faut afficher la temp√©rature retourn√©e par le capteur, suivi de ' C'
* **Humidit√©** : Il faut afficher l'humidit√© retourn√©e par le capteur, suivi de ' %'
* **Temps √©coul√©**: Il faut afficher le temps √©coul√© en utilisant le format: 0 jours(s) 00:00:00
  + üëâ **√âL√âMENT PRESCRIT OBLIGATOIRE**: Utiliser la fonction ***snprintf()***.
  + **NOTE**: Il y a un point boni pour la gestion du **(s)** √† jour. Voir la grille de correction.
* **Option**: Il faut afficher la touche saisie du clavier.
* **Projet r√©alis√© par**: Il faut inscrire votre Nom

---

## Remise

Remettre, via LEA, les fichiers suivants de votre projet:

* Les codes source (fichiers .cpp)
* Les fichiers d'ent√™te (fichiers .h ‚Äì les votre)
* Le fichier platformio.ini

---

## Grille de correction de la partie 01

### Crit√®res de performance

* Les directives du devis doivent-√™tre respect√©es.
* Le code source doit-√™tre bien document√©.
* Le code source doit-√™tre optimis√©.
  + Par de r√©p√©titions inutiles: utilisez des fonctions.
* Le projet doit-√™tre fonctionnel.
* Le projet doit-√™tre livr√© √† temps.

| Item | Description | Pond√©ration |
| --- | --- | --- |
| 1 | Bloc commentaires d'ent√™te, documentation du code, noms significatifs pour const, MACROs, variables, fonctions, ‚Ä¶ | 1,75 |
| 2 | Constantes, MACROs et inclusions dans le fichier projet.h. | 1 |
| 3 | Normalisation (pas de r√©p√©tition), utilisation de const et/ou MACRO et optimisation du code. | 1,5 |
| 4 | Instructions de garde dans les fichiers d'ent√™te | 0,5 |
| 5 | Programmation des fonctions afficherOnOff() et afficherTemperatureEtHumidite(). | 1,5 |
| 6 | Saisie des options du menu √† partir du clavier et affichage de la s√©lection. | 1 |
| 7 | Utilisation correcte de la fonction snprintf(). | 1 |
| 8 | Affichage des √©l√©ments; ON/OFF, temps, C et %, couleurs, gestion du curseur. | 2 |
| 9 | Contr√¥le des modules LEDs, Relai et affichage sur le LCD: temps √©coul√©. | 2 |
| 10 | Vitesse du port s√©rie (UART) √† 4800. | 0,25 |
| 11 | Remise des fichiers du projet: main.cpp, projet.h, platformIO.ini. | 0,5 |
| 12 | Fonctionnalit√© du projet et respect du devis. | 2 |
| **POINT BONI** | Utilisation de l'op√©rateur ternaire dans la fonction snprintf() pour afficher 's' √† jour seulement si nbJour > 1. Par exemple, 1 jour 12:23:01, 2 jours 23:59:59 | 1 |
|  |  |  |
|  | Total | 16 /15 |

---

# Partie 02 ‚Äì Remise ‚Äì 19 mars, 16h00

<img src="../images/att-camera.webp" alt="Cam√©ra surveillance" width="500" />

---

**En utilisant un Arduino UNO, avec les modules groves suivants:**

* **LED1** sur D2
* **LED2** sur D3
* **Relai** sur D4
* **D√©tecteur de mouvement** sur D5 -> [notes de cours](https://ve2cuy.com/420-1c4/index.php/detecteur-de-mouvements/)
* **Pi√©zo** (buzzer) sur D6 -> [notes de cours](https://ve2cuy.com/420-1c4/index.php/buzzer-et-rgb-led-stick/)
* **Bouton** sur D7 pour controller le d√©tecteur de mouvement
* **Potentiom√®tre** sur **A0** -> [notes de cours](https://ve2cuy.com/420-1c4/index.php/arduino-analogread/)
* **Capteur** de temp√©rature (**SHT31**) sur I2C -> [notes de cours](https://ve2cuy.com/420-1c4/index.php/grove-module-humidite-et-temperature/)
* **RGB\_LCD** sur I2C -> [notes de cours](https://ve2cuy.com/420-1c4/index.php/grove-module-lcd-rgb-i2c/)
* **Un module RTC** pour la section '**Nous sommes ..**.'

**√âcrire une application pour Arduino UNO, en utilisant VS Code et PlatformIO, qui affiche l'√©cran suivant dans la console s√©rie (serial monitor):**

<img src="../images/Capture-decran-le-2025-02-14-a-15.02.08.png" alt="Console s√©rie partie 2" width="500" />

**Et l'√©cran suivant sur le LCD:**

<img src="../images/Capture-decran-le-2025-02-12-a-10.59.06.png" alt="LCD partie 2" width="500" />

---

**NOTE**: Les options 1 √† 6, affich√©s sur la console, sont des actions qui peuvent √™tre lanc√©es √† partir du clavier pour contr√¥ler certains modules du syst√®me.

Par exemple, pour allumer ou √©teindre la LED sur D2 il suffira d'appuyer sur la touche 1 du clavier.

<img src="../images/Capture-decran-le-2025-02-12-a-12.19.23.png" alt="Saisie clavier partie 2" width="500" />

```cpp
// Astuce: Saisie d'une touche du clavier √† partir de la console s√©rie

if (Serial.available()) {      // Si un octet disponible sur le port Serial
    commande = Serial.read();  // Lecture d'un octet (touche clavier)
    
    // Traitement de la commande ...
    if (commande == '1') alors allumer/√©teindre DEL1;
}
```

---

## D√©monstration

[Vid√©o de d√©monstration](https://ve2cuy.com/420-1c4/wp-content/uploads/2025/02/420-1c4-tp01-partie02.mov)

---

## D√©tails et actions des options du menu (Items 1 √† 6)

<img src="../images/Capture-decran-le-2025-02-12-a-12.32.47.png" alt="Menu partie 2" width="500" />

1. LED1 sur D2
   * Permet d'allumer/√âteindre la DEL connect√©e sur D2
   * Au bout de la ligne, il faut afficher l'√©tat: **ON** ou **OFF**
2. LED2 sur D3
   * Permet d'allumer/√âteindre la DEL connect√©e sur D3
   * Au bout de la ligne, il faut afficher l'√©tat: **ON** ou **OFF**
3. RELAI D4
   * Permet d'allumer/√âteindre le RELAI connect√© sur D4
   * Au bout de la ligne, il faut afficher l'√©tat: **ON** ou **OFF**
4. Celcius/Fahrenheit sur I2C
   * Permet de pr√©ciser l'unit√© d'affichage de la temp√©rature entre F et C
   * Au bout de la ligne, il faut afficher l'unit√© d'affichage de la temp√©rature: **C** ou **F**
5. D√©tecteur de mouvement sur D5
   * Permet d'activer ou d√©sactiver le traitement du d√©tecteur de mouvement.
   * Au bout de la ligne, il faut afficher **activ√©** ou **d√©sactiver**.
   * Sur la premi√®re ligne du **LCD**, il faut afficher: **Alarme: ON/OFF**
6. LCD R√©tro-√©clairage
   * Permet d'activer ou d√©sactiver le r√©tro-√©clairage du LCD
   * Au bout de la ligne, il faut afficher l'√©tat: **ON** ou **OFF**
   * **Astuce**: l*cd.setRGB(255,255,255); lcd.setRGB(0,0,0);*

---

## D√©tails des modules (appareils) de contr√¥le

* **Bouton** sur D7
  + Permet d'activer ou d√©sactiver le traitement du d√©tecteur de mouvement.
  + Au bout de la ligne, il faut afficher: **activ√©** ou **d√©sactiver**.
  + **NOTE**: Ce bouton √† la m√™me fonction que l'**item 5** du menu. Il permet √† l'utilisateur d'activer ou de d√©sactiver le d√©tecteur de mouvement sans passer par la console.
  + Sur la premi√®re ligne du **LCD**, il faut afficher: **Alarme: ON/OFF**

<img src="../images/Capture-decran-le-2025-02-12-a-11.00.42.png" alt="Bouton LCD" width="500" />

* D√©tecteur de mouvement sur **D5**
  + Si le traitement du d√©tecteur de mouvement est activ√© et qu'un mouvement est d√©tect√©, il faut changer la couleur de fond du LCD pour **rouge** et afficher l'√©cran qui suit cette liste.
    - Le syst√®me d'alarme doit sonner le **Piezo** (buzzer) sur **D6**.
    - Le programme doit attendre que le d√©tecteur de mouvement soit retourn√© √† l'√©tat **OFF** puis:
      * Arr√™ter le Piezo
      * R√©tablir l'√©cran du LCD
      * Reprendre le programme

<img src="../images/Capture-decran-le-2025-02-12-a-11.06.07.png" alt="Alarme d√©tection" width="500" />

* Capteur de temp√©rature
  + Lecture de la temp√©rature et de l'humidit√© pour affichage dans la deuxi√®me partie de l'√©cran du moniteur s√©rie.
* Potentiom√®tre sur A0
  + Sert √† renseigner le d√©lai de la boucle principale : 0 √† 1023 ms.
* Piezo (buzzer)
  + Sert √† stresser votre entourage üòâ lorsqu'un mouvement est d√©tect√©.

---

## D√©tails des √©l√©ments de la deuxi√®me partie de l'√©cran

<img src="../images/Capture-decran-le-2025-02-14-a-15.05.41.png" alt="Deuxi√®me partie √©cran partie 2" width="500" />

* D√©tecteur de mouvement : Alarme sur D6
* Temp√©rature :
* Humidit√© :
* Potentiom√®tre : D√©lai d'affichage
* Temps √©coul√©: 0 jours(s) 00:00:00 ‚Äî‚Äî Option: 9
* Affichage du jour, mois, ann√©e et de l'heure courante.
* Projet r√©alis√© par Votre Nom ici TP01 ‚Äî‚Äì Partie 02

---

## Remise

Remettre, via L√âA, le dossier complet de votre projet:

---

## Grille de correction de la partie 02

| Item | Description | Pond√©ration |
| --- | --- | --- |
| 1 | Respect du devis | 3 |
| 2 | Fonctionnalit√© | 8 |
| 3 | Normalisation | 4 |
|  |  |  |
|  | Total | 15/15 |

---

## Cr√©dits

**Document r√©dig√© par Alain Boudreault ¬© 2021-2026**
**Version 2025.03.15.01 - R√©vision 2025.12.12.1**

*Contenu par [VE2CUY](http://ve2cuy.com/blog)*